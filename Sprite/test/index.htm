<!DOCTYPE html>
<html>
	<head>
		<title>Test</title>
		<link rel='icon' href='data:;base64,iVBORw0KGgo='>
		<meta charset='UTF-8'>
		<script>
			function c(text) {
				console.log(text);
			}
		</script>
		<script src='../../Main/Main.js'></script>
		<script src='../../Point/Point.js'></script>
		<script src='../../Size/Size.js'></script>
		<script src='../../Rect/Rect.js'></script>
		<script src='../Sprite.js'></script>
		<script src='../Pivot.js'></script>
		<script src='../Mngr.js'></script>
		<script src='../AnimateMngr.js'></script>
		<script src='../ClipLayerMngr.js'></script>
		<script src='../ClipMngr.js'></script>
		<script src='../TileMngr.js'></script>
		<script src='../StaticMngr.js'></script>
		<script>
			
			let charImg   = new Image();
			charImg.src   = 'char.png';
			let charAImg  = new Image();
			charAImg.src  = 'char_animation.png';
			let charLImg  = new Image();
			charLImg.src  = 'layers.png';
			
			let char, achar, lchar;
			let cvs;
			let ctx;
			
			function draw(offsetX, offsetY, pivotText, img = null) {
				ctx.setTransform(1, 0, 0, 1, offsetX, offsetY);
				if ( img === null ) {
					char.draw(ctx);
				} else {
					img.draw(ctx);
				}
				ctx.fillText('Pivot: ' + pivotText, 0, 15);
				ctx.rect(-3, -3, 6, 6);
				ctx.stroke();
			}
			
			function text(text, x, y) {
				ctx.setTransform(1, 0, 0, 1, x, y);
				ctx.fillText(text, 0, 15);
			}
			
			function main() {
				cvs   = document.getElementById('canvas');
				ctx   = cvs.getContext('2d');
				char  = new QQ.Sprite(charImg);
				achar = new QQ.Sprite(charAImg);
				achar.setAnimation(new QQ.Point(107, 148), 3);
				lchar = new QQ.Sprite(charLImg);
				lchar.setClipLayer(new QQ.Rect(0, 0, 171, 150));
				lchar.addClipLayer(new QQ.Point(171, 0));
				lchar.addClipLayer(new QQ.Rect(418, 75, 16, 16));
				frame();
			}
			
			function frame() {
				requestAnimationFrame(frame);
				ctx.setTransform(1, 0, 0, 1, 0, 0);
				ctx.clearRect(0, 0, cvs.width, cvs.height);
				
				// STATIC
				char.setStatic();
				char.setAnchor(new QQ.Point(0.5, 0.5));
				draw(60, 75, '0.5 0.5');
				char.setAnchor(new QQ.Point(0.75, 0.25));
				char.setAlpha(0.5);
				draw(220, 40, '0.75, 0.25 (Alpha)');
				char.setAlpha(1);
				text('Image ratio: '  + char.getRatio(),         0, 170);
				text('Image width '   + char.getSize().width(),  0, 190);
				text('Image height: ' + char.getSize().height(), 0, 210);
				
				// CLIP
				char.setClip(new QQ.Rect(49, 43, 28, 45));
				char.setAnchor(new QQ.Point(0.5, 0.5));
				draw(60, 300, '0.5 0.5');
				char.setAnchor(new QQ.Point(0.75, 0.25));
				char.setAlpha(0.5);
				draw(180, 290, '0.75, 0.25 (Alpha)');
				char.setAlpha(1);
				text('ratio Image: '  + char.getRatio(),         0, 370);
				text('Image width '   + char.getSize().width(),  0, 390);
				text('Image height: ' + char.getSize().height(), 0, 410);

				// ANIMATE
				achar.setAnchor(new QQ.Point(0.5, 0.5));
				draw(60,  525, '0.5 0.5', achar);
				achar.setAnchor(new QQ.Point(0.75, 0.25));
				achar.setAlpha(0.5);
				draw(220, 485, '0.75, 0.25 (Alpha)', achar);
				achar.setAlpha(1);
				text('Image ratio: ' + achar.getRatio(),       0, 600);
				text('Image width ' + achar.getSize().width(),  0, 615);
				text('Image height: ' + achar.getSize().height(), 0, 630);
					
				// LAYERS
				lchar.setAnchor(new QQ.Point(0.5, 0.5));
				draw(100, 750, '0.5 0.5', lchar);
				lchar.setAnchor(new QQ.Point(0.75, 0.25));
				lchar.setAlpha(0.5);
				draw(350, 700, '0.75, 0.25 (Alpha)', lchar);
				lchar.setAlpha(1);
				text('Image ratio: ' + lchar.getRatio(),       0, 850);
				text('Image width ' + lchar.getSize().width(),  0, 865);
				text('Image height: ' + lchar.getSize().height(), 0, 880);
				
				// TILE
				char.setTileSize(new QQ.Size(50, 30), new QQ.Size(100, 50));
				char.setAnchor(new QQ.Point(0.5, 0.5));
				draw(60,  950, '0.5 0.5');
				char.setAnchor(new QQ.Point(0.75, 0.25));
				char.setAlpha(0.5);
				draw(200, 940, '0.75, 0.25 (Alpha)');
				char.setAlpha(1);
				text('Image ratio: ' + char.getRatio(),       0, 1000);
				text('Image width ' + char.getSize().width(),  0, 1010);
				text('Image height: ' + char.getSize().height(), 0, 1020);
			}
		</script>
	</head>
	<body onload='main()'>
		<canvas id='canvas' width='1300' height='1200'></canvas>
	</body>
</html>
